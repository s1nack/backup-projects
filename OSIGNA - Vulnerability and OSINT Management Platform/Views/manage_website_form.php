<div id="main-content" style="padding:0; padding-top:0px; padding-left:0px;">
<div id="scan-content" style="padding:0; padding-top:0px; padding-left:0px;">
	<div id="scan_form">
	<?php
		echo form_open('scan/index/');
		echo "<div style='position:relative;'><span style='color:black;font-size:12px;line-height:18px;'>Host&nbsp;&nbsp;&nbsp;&nbsp;". form_dropdown('sites', $opt[0], $opt[2])."</span>";
		echo "<span style='position:absolute;margin-left:50px;margin-top:-5px;'><button class='action red'><span class='label'>Scan</span></button></span></div>";
		echo form_close();
	?>
	<style>
	.numberCircle {
    -webkit-border-radius: 999px;
    -moz-border-radius: 999px;
    border-radius: 999px;
    behavior: url(PIE.htc);

    width: 20px;
    height: 20px;
	margin: 0px auto;
	margin-top: 3px;
    
    background-color: transparent;
    border: 2px solid #DC143C;
    color: #666;
    text-align: center;
    
    font: 18px Arial, sans-serif
	}
	
	.medium {
	border: 2px solid #ff9911;
	}
	
	.low {
	border: 2px solid #00bb00;
	}
	
	.info {
	border: 2px solid #2CDEF2;
	}
	
	.numberContainer {
	background-color: transparent; height:30px; width:50px; position: absolute; 
	border-left-width:1px; border-left-style:solid; border-left-color:#bbb;
	border-top-width:1px; border-top-style:solid; border-top-color:#bbb;
	border-bottom-width:1px; border-bottom-style:solid; border-bottom-color:#bbb;
	}
	
	.numberContainer:hover {
	background-color: #ccc;
	}
	
	.numberContainer:active {
	border-left-width:2px; border-right-width:2px; border-top-width:2px; border-bottom-width:2px;
	}
	
	.numberContainerSelected {
	background-color: #ccc; height:30px; width:50px; position: absolute; 
	border-left-width:1px; border-left-style:solid; border-left-color:#bbb;
	border-top-width:1px; border-top-style:solid; border-top-color:#bbb;
	border-bottom-width:1px; border-bottom-style:solid; border-bottom-color:#bbb;
	}?

	</style>
	<style>
/*--------------------------------------------------
  REQUIRED to hide the non-active tab content.
  But do not hide them in the print stylesheet!
  --------------------------------------------------*/
.tabberlive .tabbertabhide {
 display:none;
}

/*--------------------------------------------------
  .tabber = before the tabber interface is set up
  .tabberlive = after the tabber interface is set up
  --------------------------------------------------*/
.tabber {
}
.tabberlive {
 margin-top:1em;
}

/*--------------------------------------------------
  ul.tabbernav = the tab navigation list
  li.tabberactive = the active tab
  --------------------------------------------------*/
ul.tabbernav
{
 margin:0;
 padding: 3px 0;
 border-bottom: 1px solid #778;
 font: bold 12px Verdana, sans-serif;
}

ul.tabbernav li
{
 list-style: none;
 margin: 0;
 display: none;
}

ul.tabbernav li a
{
 padding: 3px 0.5em;
 margin-left: 3px;
 border: 1px solid #778;
 border-bottom: none;
 background: #DDE;
 text-decoration: none;
}

ul.tabbernav li a:link { color: #448; }
ul.tabbernav li a:visited { color: #667; }

ul.tabbernav li a:hover
{
 color: #000;
 background: #AAE;
 border-color: #227;
}

ul.tabbernav li.tabberactive a
{
 background-color: #fff;
 border-bottom: 1px solid #fff;
}

ul.tabbernav li.tabberactive a:hover
{
 color: #000;
 background: white;
 border-bottom: 1px solid white;
}

/*--------------------------------------------------
  .tabbertab = the tab content
  Add style only after the tabber interface is set up (.tabberlive)
  --------------------------------------------------*/
.tabberlive .tabbertab {
 padding:5px;
 border:1px solid #aaa;
 border-top:0;

 /* If you don't want the tab size changing whenever a tab is changed
    you can set a fixed height */

 /* height:200px; */

 /* If you set a fix height set overflow to auto and you will get a
    scrollbar when necessary */

 /* overflow:auto; */
}

/* If desired, hide the heading since a heading is provided by the tab */
.tabberlive .tabbertab h2 {
 display:none;
}
.tabberlive .tabbertab h3 {
 display:none;
}

/* Example of using an ID to set different styles for the tabs on the page */
.tabberlive#tab1 {
}
.tabberlive#tab2 {
}
.tabberlive#tab2 .tabbertab {
 height:200px;
 overflow:auto;
}
	</style>
	
	<script>
	var button = "cont4";
	function select(object)
	{
		if(object.id != button)
		{
			document.getElementById(button).className = "numberContainer";
			object.className = "numberContainerSelected";
			button = object.id;
			loadTable("test");
		}
		return false;
	}
	
	function loadTable(scope)
	{
		var contentVulnList = '<table><thead>'+
'<tr>'+
'<th><input class="check-all" type="checkbox"></th>'+
'<th>Vulnerability</th>'+
'<th>Impact</th>'+
'<th>Webpage</th>'+
'<th>Quick actions</th>'+
'</tr>'+
'</thead>'+						 
'<tfoot>'+
'<tr>'+
'<td colspan="6">'+
'<div class="bulk-actions align-left">'+
'<select name="dropdown">'+
'<option value="option1">Choose an action...</option>'+
'<option value="option2">Ackknowledge</option>'+
'<option value="option3">Assign ticked number</option>'+
'</select>'+
'<a class="button" href="#">Apply to selected</a>'+
'</div>'+
'<div class="clear"></div>'+
'</td>'+
'</tr>'+
'</tfoot>'+
'<tbody>';

var dynamicContentVulnList = '<tr class="alt-row">'+
'<td><input type="checkbox"></td>'+
'<td><a href="#" title="title" style="color:#000;">XSS</a></td>'+
'<td><span style="color:red">CRITICAL</span></td>'+
'<td>/products/showproducts.asp</td>'+
'<td>'+
'<a href="#" title="Edit"><img src="resources/images/icons/pencil.png" alt="Edit"></a>'+
'<a href="#" title="Delete"><img src="resources/images/icons/cross.png" alt="Delete"></a>'+ 
'<a href="#" title="Edit Meta"><img src="resources/images/icons/hammer_screwdriver.png" alt="Edit Meta"></a>'+
'</td>'+
'</tr>'+
'</tbody>'+
'</table>';

var fullList = contentVulnList.concat(dynamicContentVulnList);

document.getElementById("vulnList").innerHTML = fullList;
return true;
}
	</script>

	<script type='text/javascript'>
      google.load('visualization', '1', {packages:['orgchart']});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Name');
        data.addColumn('string', 'Manager');
        data.addColumn('string', 'ToolTip');
        data.addRows([
          [{v:'/home', f:'/home<div style="color:red; font-style:italic">start url</div>'}, '', 'Start URL'],
          [{v:'/product', f:'/product<div style="color:red; font-style:italic">1 critical vuln</div>'}, '/home', 'VP'],
		  ['/services', '/home', ''],
		  ['/appliance', '/home', ''],
		  ['/foo', '/home', ''],
		  ['/test', '/home', ''],
		  ['/content', '/home', ''],
          ['/about', '/home', ''],
		  ['abc','/home',''],
		  ['abcd','/home',''],
		  ['abcde','/home',''],
          ['/faq', '/about', 'Bob Sponge'],
          ['/contact', '/faq', '']
        ]);
		//data.setRowProperty(2,'style', 'border:2px solid green');
        var chart = new google.visualization.OrgChart(document.getElementById('chart_div'));
        chart.draw(data, {allowHtml:true, allowCollapse:true, size:'medium'});
      }
    </script>

	
	<style>
.etabs { margin: 0; padding: 0; }
.tab { display: none; zoom:1; *display:inline; background: #eee; border: solid 1px #999; border-bottom: none; -moz-border-radius: 4px 4px 0 0; -webkit-border-radius: 4px 4px 0 0; }
.tab a { font-size: 14px; line-height: 2em; display: block; padding: 0 10px; outline: none; }
.tab a:hover { text-decoration: underline; }
.tab.active { background: #fff; padding-top: 6px; position: relative; top: 1px; border-color: #666; }
.tab a.active { font-weight: bold; }
.tab-container .panel-container { background: #fff; border: solid #666 1px; padding: 10px; -moz-border-radius: 0 4px 4px 4px; -webkit-border-radius: 0 4px 4px 4px; }
	</style>

	
	<div id="foo">
		<div id="tab-container" class="tab-container">
		  <ul class='etabs' style="height:10px;">
			<li class='tab'><a href="#xtab0"></a></li>
			<li class='tab'><a href="#xtab1"></a></li>
			<li class='tab'><a href="#xtab2"></a></li>
			<li class='tab'><a href="#xtab3"></a></li>
		  </ul>
		  <div id="xtab0">
			<div id="summary" style="position:relative;height:100px;width:450px;background-color:transparent;line-height:20px;font-size:13px;font-family:Arial, sans-serif;">
				
				<span style="color:black;font-size:18px;">Website</span></br>
				<span style="color:#000">Site url :</span><span style="color:#777"> (favicon div) http://www.olfeo.com</span></br>
				<span style="color:#000">IP address (ipv4) :</span><span style="color:#777"> 10.11.12.13</span></br>
				<span style="color:#000">Date ajout :</span><span style="color:#777"> 10/11/2012</span></br>
				<span style="color:#000">Security token :</span><span style="color:#777"> 38758957384738947</span></br></br>
				
				<span style="color:black;font-size:18px;">Server</span></br>
				<span style="color:#000">IP address (ipv4) :</span><span style="color:#777"> 10.11.12.13</span></br>
				<span style="color:#000">Services <span style="color:#bbb;font-style:italic;">(port - service)</span> : </span></br>
				<span style="color:#777;margin-left:20px;">21 - ftpd (proftpd/2.1.3 banner-content-here)</span></br>
				<span style="color:#777;margin-left:20px;">22 - sshd server (openssh/4.0.1 banner-content-here)</span></br>
				<span style="color:#777;margin-left:20px;">80 - httpd (apache2/httpd banner-content-here)</span></br>
				<span style="color:#777;margin-left:20px;">8080 - http proxy (squid/2.6 banner-content-here)</span></br></br>
				
				<span style="color:black;font-size:18px;">Infrastructure</span></br>
				<span style="color:#000">DNS server :</span><span style="color:#777"> ns.olfeo.com (10.11.12.10)</span></br>
				<span style="color:#000">Domain expires :</span><span style="color:#777"> 10/11/2013</span></br>
				<span style="color:#000">Domain owner :</span><span style="color:#777"> OLFEO</span></br></br>
				
				<span style="color:black;font-size:18px;">Security overview</span></br>
				<span style="color:#000">Status :</span><span style="color:green"> SECURE</span></br>
				<span style="color:#000">Last scan :</span><span style="color:#777"> 10/11/2012</span></br>
				<span style="color:#000">Pages found :</span><span style="color:#777"> 123</span></br>
				
				
			</div>
		  </div>
		  <div id="xtab1">
			<span style="color:#000">Vulnerabilities found :</span><span style="color:#777"> 3 (5% pages)</span></br></br>
			<span>Filter results :</span>
			<div style="background-color: transparent; height:50px; position: relative;">
				<div id="cont1" class="numberContainer">
					<div id="numCrit" class="numberCircle"><?php echo $opt[1]['crit']; ?></div>
				</div>
				<div id="cont2" class="numberContainer" style="left:50px;">
					<div class="numberCircle medium"><?php echo $opt[1]['med']; ?></div>
				</div>
				<div id="cont3" class="numberContainer" style="left:100px;">
					<div class="numberCircle low"><?php echo $opt[1]['low']; ?></div>
				</div>
				<div id="cont4" class="numberContainerSelected" style="left:150px; border-right-width:1px; border-right-style:solid; border-right-color:#bbb;">
					<div class="numberCircle info">All</div>
				</div>
			</div>
	<div id="vulnList" style="width:800px;border:1px solid #bbb;">
	<table class="someclass">
							<thead>
								<tr class="head">
								   <th><input class="check-all" type="checkbox"></th>
								   <th>Vulnerability</th>
								   <th>Impact</th>
								   <th>Webpage</th>
								   <th>Quick actions</th>
								</tr>
							</thead>
						 
							<tfoot>
								<tr class="foot">
									<td colspan="6">
										<div class="bulk-actions align-left">
											<select name="dropdown">
												<option value="option1">Choose an action...</option>
												<option value="option2">Ackknowledge</option>
												<option value="option3">Assign ticked number</option>
											</select>
											<a class="button" href="#">Apply to selected</a>
										</div>
										<div class="clear"></div>
									</td>
								</tr>
							</tfoot>
						 
							<tbody>
								<tr class="alt-row crit">
									<td><input type="checkbox"></td>
									<td><a href="#" title="title" style="color:#000;">XSS</a></td>
									<td><span style="color:red">CRITICAL</span></td>
									<td>/products/showproducts.asp</td>
									<td>
										<!-- Icons -->
										 <a href="#" title="Edit"><img src="http://www.datalabsecurity.com/webscan/resources/img/pencil.png" alt="Edit"></a>
										 <a href="#" title="Delete"><img src="http://www.datalabsecurity.com/webscan/resources/img/cross.png" alt="Delete"></a> 
										 <a href="#" title="Edit Meta"><img src="http://www.datalabsecurity.com/webscan/resources/img/hammer_screwdriver.png" alt="Edit Meta"></a>
									</td>
								</tr>
								
								<tr class="crit">
									<td><input type="checkbox"></td>
									<td><a href="#" title="title" style="color:#000;">SQLi</a></td>
									<td><span style="color:red">CRITICAL</span></td>
									<td>/products/newproduct?id=[payload]</td>
									<td>
										<!-- Icons -->
										 <a href="#" title="Edit"><img src="http://www.datalabsecurity.com/webscan/resources/img/pencil.png" alt="Edit"></a>
										 <a href="#" title="Delete"><img src="http://www.datalabsecurity.com/webscan/resources/img/cross.png" alt="Delete"></a> 
										 <a href="#" title="Edit Meta"><img src="http://www.datalabsecurity.com/webscan/resources/img/hammer_screwdriver.png" alt="Edit Meta"></a>
									</td>
								</tr>
								
								<tr class="alt-row med">
									<td><input type="checkbox"></td>
									<td><a href="#" title="title" style="color:#000;">XSRF</a></td>
									<td><span style="color:orange">MEDIUM</span></td>
									<td>/login/changepasswd.php?user=[payload]</td>
									<td>
										<!-- Icons -->
										 <a href="#" title="Edit"><img src="http://www.datalabsecurity.com/webscan/resources/img/pencil.png" alt="Edit"></a>
										 <a href="#" title="Delete"><img src="http://www.datalabsecurity.com/webscan/resources/img/cross.png" alt="Delete"></a> 
										 <a href="#" title="Edit Meta"><img src="http://www.datalabsecurity.com/webscan/resources/img/hammer_screwdriver.png" alt="Edit Meta"></a>
									</td>
								</tr>
							</tbody>
						</table>
				</div>
		  </div>
		  <div id="xtab2">
			<div id="chart_div" style="border-collapse:separate;border:1px solid #777;width:90%;padding:10px;"></div>
			<!-- content -->
		  </div>
		  <div id="xtab3">
			<h2>CSS Styles for these tabs</h2>
			<!-- content -->
		  </div>
		</div>
	</div>
	
	<script type="text/javascript">
		$('#tab-container').easytabs();
	</script>
	
	
	</br></br></br></br>
	</div>
</div>
</div>

<?php
if ($opt_head["defaultTab"] != NULL)
{
	echo '<script>$("#tab-container").easytabs("select", "#xtab'.$opt_head["defaultTab"].'");</script>';
}
?>

	<script>
	var rows = $('table.someclass tr');

	$('#cont1').click(function() {
		//var head = rows.filter('.head').show();
		//var crit = rows.filter('.crit').show();
		rows.hide();
		rows.filter('.head').show();
		rows.filter('.crit').show();
		rows.filter('.foot').show();
	});

	$('#cont2').click(function() {
		rows.hide();
		rows.filter('.head').show();
		rows.filter('.med').show();
		rows.filter('.foot').show();
	});
	
	$('#cont3').click(function() {
		rows.hide();
		rows.filter('.head').show();
		rows.filter('.low').show();
		rows.filter('.foot').show();
	});

	$('#cont4').click(function() {
		rows.show();
	});
	</script>