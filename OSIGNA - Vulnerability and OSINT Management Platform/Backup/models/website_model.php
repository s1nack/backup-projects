<?php

class Website_model extends CI_Model {

	function create_site($userid, $url, $ipv4)
	{
		$v = array(
			'url' => $url,
			'ipv4' => $ipv4,
			'fk_user_id' => $userid,
		);
		$i = $this->db->insert('users', $v);
		return $i;
	}
	
	function get_secureToken($userid)
	{
		$query = $this->db->query("SELECT securetoken FROM users WHERE id='".$userid."'");
		return $query->row()->securetoken;
	}

	function getWebsiteIdsByUserid($userid) 
	{
		//return null;
		//echo "userid = " . $userid;
		$query = $this->db->query("SELECT id FROM sites WHERE fk_user_id='".$userid."'");
		//print_r($query);
		//$a = array();
		//foreach($query->row() as $f)
		//{
		//	echo "f " . $f . "hihi";
		//}
		//return $query->row()->id;
		return $query->result_array();
	}
	
	function getUrlsByUserid($userid) 
	{	
		$query = $this->db->query("SELECT url FROM sites WHERE fk_user_id='".$userid."'");
		return $query->row()->url;
	}
	
	function get_url_by_id($siteid)
	{
		//echo "Site id = " . print_r($siteid);
		$query = $this->db->query("SELECT url FROM sites WHERE id='".$siteid."'");
		return $query->row()->url;
	}
	
	function get_all($sites)
	{
		$querystr = "SELECT * FROM sites WHERE id=";
		$i = 0;
		foreach($sites as $site)
		{
			if ($i == 0)
			{
				$querystr = $querystr . $site;
			}
			else 
			{
				$querystr = $querystr . " OR id=".$site;
			}
			$i++;
		}
		//$query = $this->db->query("SELECT * FROM websites WHERE id=x OR id=x OR id=x");
		//echo "</br>query = " . $querystr . "</br>";
		$query = $this->db->query($querystr);
		//print_r($query);
		return $query;
	}
}